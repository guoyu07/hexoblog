<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>我所理解的登录 | Wilee</title>
  <meta name="author" content="xiongwilee">
  
  <meta name="description" content="blog">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="我所理解的登录"/>
  <meta property="og:site_name" content="Wilee"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Wilee" type="application/atom+xml">
  <link rel="stylesheet" href="/bootstrap/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="/fontawesome/css/font-awesome.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">

  <script src="//apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
  <!--[if lt IE 9]><script src="/js/html5.js"></script><![endif]-->
  
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F3460af47268846ca3d274b44b6aeb8ce' type='text/javascript'%3E%3C/script%3E"));
</script>

</head>

<body>
  <header id="header" class='normal_mode'>
    <div id="top">
  <nav id="nav">
    <ul class='main-nav-ul'><!-- 
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/about">About</a></li>
       -->
      <li><a href="/"><i class="fa fa-home"></i></a></li>
    </ul>
  </nav>
  <form id="search" class="search" action="http://www.baidu.com/s" method="get">
  	<input type="text" class="search_text" placeholder="search" autocomplete="off">
  	<input type="hidden" class="search_hidden" name="wd">
  	<button type="submit" class="search_btn fa fa-search"></button>
  </form>
</div>
<script>
(function($){
  $('#search .search_btn').click(function(){
    var formEle = $('#search'),
      textEle = $("#search .search_text"),
      hiddenEle = $("#search .search_hidden");
    hiddenEle.val(textEle.val()+' site:wilee.me');
    formEle.submit()
  })
})(jQuery)
</script>
  </header>
  <div id="content" class="container" data-0="box-shadow:0px 0px 100px rgba(0,0,0,.5)" data-800="box-shadow:0px 0px 1000px rgba(0,0,0,1)">
    <article class="post">
  <div class="post-content">
    <header>
      
      
  
    <h1 class="title">我所理解的登录</h1>
  

<div class="collection">
  
  
</div>
<time datetime="2015-06-08T23:32:22.000Z"><a href="/2015/06/09/slider-test/">2015-06-09 07:32</a></time>
<div class="clear"></div>
      
    </header>
    
      
        <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"><i class="fa fa-chevron-left"></i></div>
    <div class="next"><i class="fa fa-chevron-right"></i></div>
  </div>
</div>
      
      <div class="entry">
        
          <h1 id="我所理解的登录（Ⅰ）">我所理解的登录（Ⅰ）</h1>
<p>—— 前端工程师用最精简的代码打造最精致的用户体验之路</p>
<h2 id="从百度登录功能重构说起">从百度登录功能重构说起</h2>
<h3 id="背景">背景</h3>
<ul>
<li>请求数量巨大<ul>
<li>每天500万次调起，服务于百度10亿+用户；</li>
<li>每天主动登录用户数300万，注册用户数20万</li>
</ul>
</li>
<li>服务于70+产品线<ul>
<li>环境不同：基础库（jQuery，Tangram），多语言，安全性 …</li>
<li>使用场景不同：弹框+内嵌</li>
<li>客户端不同：PC，PC客户端，iPad Webapp…</li>
</ul>
</li>
<li>整套组件包含几乎所有的帐号相关的操作<ul>
<li>登录页/框</li>
<li>注册页/框</li>
<li>验证组件</li>
<li>补填用户名</li>
<li>帐号绑定</li>
<li>…</li>
</ul>
</li>
</ul>
<h3 id="老版的百度登录框/页">老版的百度登录框/页</h3>
<ul>
<li>老版的百度登录框：</li>
</ul>
<p><img src="http://bizfe.meilishuo.com/md-imgs/aab20e60016265126b05400f058cbc37.png" alt="QQ20141105-1@2x"></p>
<ul>
<li>老版的百度登录页：<a href="http://cang.baidu.com/" target="_blank" rel="external">百度搜藏</a></li>
</ul>
<h3 id="新版的百度登录框/页">新版的百度登录框/页</h3>
<ul>
<li>新版的百度登录框：</li>
</ul>
<p><img src="http://bizfe.meilishuo.com/md-imgs/721eedb31a61662184bcfccf3ee579c2.png" alt="百度登录框"></p>
<ul>
<li>新版的百度登录页：<a href="http://passport.baidu.com/" target="_blank" rel="external">登录百度帐号</a></li>
</ul>
<h3 id="几点思考">几点思考</h3>
<h4 id="用户体验是不是被过度放大了？">用户体验是不是被过度放大了？</h4>
<blockquote>
<p><strong> 可用性 </strong> —— 当没钱的时候，穿一身破衣服，能保暖就行，这是基本需求；</p>
<p><strong> 易用性 </strong> —— 当有些钱了，就希望穿一身好看衣服，这样能显得整个人更好看，这就是基本体验了；</p>
<p><strong> 好用性 </strong> —— 当有闲钱了，就开始买一些简单的首饰，涂脂抹粉画眼线，这就是增强体验；</p>
<p><strong> 品牌价值 </strong> —— 当非常有钱了，开始穿金戴银，貂皮大衣，这时候你要彰显的是品位，这就是品牌需求了</p>
</blockquote>
<p>引自：<a href="http://www.zhihu.com/question/19562401" target="_blank" rel="external">【知乎】用户体验是不是被过度放大了</a></p>
<h4 id="登录的基本特征">登录的基本特征</h4>
<ul>
<li>保障帐号安全（Security）</li>
<li>可操作（Accessibility）</li>
<li>效率（Efficiency）</li>
</ul>
<h4 id="现在的美丽说登录页">现在的美丽说登录页</h4>
<p><a href="https://account.meilishuo.com/user/login" target="_blank" rel="external">https://account.meilishuo.com/user/login</a></p>
<h2 id="百度登录框改进思路">百度登录框改进思路</h2>
<p><strong> 站在用户的角度，与技术结合，做更富有情感的产品。 </strong> </p>
<h3 id="一段代码的价值">一段代码的价值</h3>
<ul>
<li>使用for属性规定 label 与哪个表单元素绑定。<br><figure class="highlight HTML"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"checkbox"</span> <span class="attribute">name</span>=<span class="value">"is_remember"</span> <span class="attribute">id</span>=<span class="value">"is_remember"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"is_remember"</span>&gt;</span>是否记住登录状态<span class="tag">&lt;/<span class="title">label</span>&gt;</span></div></pre></td></tr></table></figure><ul>
<li>扩大热点区域，使操作更方便 </li>
</ul>
</li>
</ul>
<ul>
<li>placeholder<br><figure class="highlight HTML"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">id</span>=<span class="value">"username"</span> <span class="attribute">placeholder</span>=<span class="value">"用户名/手机号/邮箱"</span>/&gt;</span></div></pre></td></tr></table></figure><br><figure class="highlight JavaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">_isSupportPlaceholder:<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span></div><div class="line">	<span class="keyword">return</span> <span class="string">'placeholder'</span> <span class="keyword">in</span> document.createElement(<span class="string">'input'</span>)</div><div class="line">}</div></pre></td></tr></table></figure><ul>
<li>用户在没有任何输入的情况下默认提示文案；</li>
<li>如果是低端浏览器，可以通过<code>_isSupportPlaceholder</code>方法来判断是否支持<code>placeholder</code>；如果不支持，可以用DOM模拟placeholder</li>
</ul>
</li>
</ul>
<ul>
<li>tabindex<figure class="highlight HTML"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">'text'</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">tabindex</span>=<span class="value">"1"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">'text'</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">tabindex</span>=<span class="value">"2"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">'submit'</span> <span class="attribute">value</span>=<span class="value">"提交"</span> <span class="attribute">tabindex</span>=<span class="value">"3"</span>&gt;</span></div></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li>三态（默认状态，hover,focus）的样式处理<br><figure class="highlight CSS"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">input</span><span class="rules">{<span class="rule"><span class="attribute">background</span>:<span class="value">#</span></span></span>}</div><div class="line"><span class="tag">input</span><span class="pseudo">:hover</span><span class="rules">{<span class="rule"><span class="attribute">background</span>:<span class="value">#</span></span></span>}</div><div class="line"><span class="tag">input</span><span class="pseudo">:focus</span><span class="rules">{<span class="rule"><span class="attribute">background</span>:<span class="value">#</span></span></span>}</div></pre></td></tr></table></figure><ul>
<li>不同的状态，给予用户不同的反馈</li>
</ul>
</li>
</ul>
<ul>
<li>提交时密码输入有误或为空，清空密码表单值，自动聚焦到密码表单<br><figure class="highlight JavaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ele.value = <span class="string">""</span>;</div><div class="line">ele.focus();</div></pre></td></tr></table></figure><ul>
<li>减少用户操作成本，代码可以完成的就不需要用户操作</li>
</ul>
</li>
</ul>
<ul>
<li>当前状态提醒，“登录中…”<br><figure class="highlight JavaScript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ele.value = <span class="string">"登录中"</span></div></pre></td></tr></table></figure><ul>
<li>异步提交数据期间，用户应该得到反馈；被告知正在发送数据。</li>
</ul>
</li>
</ul>
<ul>
<li>超时提醒<br><figure class="highlight JavaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span></div><div class="line">    <span class="keyword">if</span>(!isLogin){</div><div class="line">        showMsg(<span class="string">'可能是网络原因登录超时，请稍候再试。'</span>)</div><div class="line">    }</div><div class="line">},<span class="number">5000</span>)</div></pre></td></tr></table></figure><ul>
<li>如果在打开页面到用户操作期间，用户网络的出问题；异步登录请求将没有任何返回，此时，如果等待超时则予以提示</li>
</ul>
</li>
</ul>
<ul>
<li>大小写锁定提示<br><figure class="highlight JavaScript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> isShift = e.shiftKey || (keyCode == <span class="number">16</span>) || <span class="literal">false</span></div><div class="line"><span class="keyword">if</span> (((keyCode &gt;= <span class="number">65</span> && keyCode &lt;= <span class="number">90</span>) && !isShift) || ((keyCode &gt;= <span class="number">97</span> && keyCode &lt;= <span class="number">122</span>) && isShift)) {</div><div class="line">    <span class="comment">//do something here</span></div><div class="line">}</div></pre></td></tr></table></figure><ul>
<li>如果用户开启了大写锁定提示，则予以提示</li>
</ul>
</li>
</ul>
<h3 id="更多思路">更多思路</h3>
<ul>
<li><p>autosuggest</p>
<ul>
<li>输入邮箱/历史纪录的自动提示</li>
</ul>
</li>
<li><p>开放回调方法</p>
<ul>
<li>用户在未登录的情况下操作被中断，弹出登录框用登录成功后应该继续用户之前的操作</li>
</ul>
</li>
</ul>
<ul>
<li><p>校验器</p>
<ul>
<li>输入达到某个字符数时校验</li>
<li>blur时，字段格式校验</li>
<li>提交表单时，整体校验</li>
</ul>
</li>
<li><p>所有连接加上当前用户名/邮箱/手机号</p>
<ul>
<li>“尚未注册”，“找回密码？”，“查看帮助”，链接带上用户名，然后在目的页自动填充</li>
</ul>
</li>
</ul>
<ul>
<li><p>只有当用户的连续输错三次密码才会提示输入验证码，并且提示用户在多长时间内修改过密码</p>
<ul>
<li>与风控策略有关，避免每次登录都输入验证码。</li>
</ul>
</li>
<li><p>验证码输入错误，自动更新验证码，验证码表单清空，自动聚焦到验证码表单</p>
<ul>
<li>减少用户操作成本</li>
</ul>
</li>
<li><p>…</p>
</li>
</ul>
<h2 id="下期预告">下期预告</h2>
<blockquote>
<p>我所理解的登录</p>
<p>——面对精致的需求如何构建高复用，易维护，高性能的代码</p>
<h3 id="挑战">挑战</h3>
<ul>
<li>服务于70+用户产品线：基础库不一，交互需求不同，客户端不同</li>
<li>更新迭代：缓存机制</li>
<li>国际化：多语言支持</li>
<li>安全：RSA加密，POST/HTTPS,TOKEN</li>
<li>反作弊：用户行为数据收集</li>
</ul>
<h3 id="思考">思考</h3>
<p>… </p>
</blockquote>
<h1 id="我所理解的登录（Ⅱ）">我所理解的登录（Ⅱ）</h1>
<p>—— 如何为适配产品需求选择更合适的技术架构</p>
<h2 id="需求场景">需求场景</h2>
<ul>
<li>交互统一性，维度：不同产品线，不同客户端</li>
<li>安全性保障</li>
<li>可复用，高性能，易维护</li>
</ul>
<h2 id="如何构建一套架构实现所有的功能？">如何构建一套架构实现所有的功能？</h2>
<h3 id="功能点">功能点</h3>
<p>登录，弹框登录，注册，绑定手机号，补填用户名等</p>
<h3 id="DEMO">DEMO</h3>
<p>登录：</p>
<p><a href="http://passport.baidu.com/passApi/html/loginMerge.html" target="_blank" rel="external">http://passport.baidu.com/passApi/html/loginMerge.html</a></p>
<p>注册：</p>
<p><a href="http://passport.baidu.com/passApi/html/reg.html" target="_blank" rel="external">http://passport.baidu.com/passApi/html/reg.html</a></p>
<p>弹框登录：</p>
<p><a href="http://passport.baidu.com/passApi/html/dia-noimg.html" target="_blank" rel="external">http://passport.baidu.com/passApi/html/dia-noimg.html</a></p>
<p>弹框登录iPad版：</p>
<p><a href="http://passport.baidu.com/passApi/html/loginPad_uni.html" target="_blank" rel="external">http://passport.baidu.com/passApi/html/loginPad_uni.html</a></p>
<h2 id="思路">思路</h2>
<h3 id="iframe实现功能页面，产品线嵌套">iframe实现功能页面，产品线嵌套</h3>
<blockquote>
<p>提供给产品线一个页面，使产品线通过iframe嵌套实现登录</p>
</blockquote>
<h4 id="特征">特征</h4>
<blockquote>
<p>优点</p>
</blockquote>
<ul>
<li>实现成本低</li>
<li>每套功能都有一个页面，管理方便</li>
<li>独立的页面实现，安全性更高</li>
</ul>
<blockquote>
<p>缺点</p>
</blockquote>
<ul>
<li>产品线订制灵活度不高，UI/callback等无法满足产品线需求</li>
<li>不能抓取到当前页面的信息</li>
<li>产品线接入成本高</li>
</ul>
<h3 id="提供JS_Api">提供JS Api</h3>
<blockquote>
<p>提供JS Api生成DOM实现业务逻辑</p>
</blockquote>
<h4 id="特征-1">特征</h4>
<blockquote>
<p>优点</p>
</blockquote>
<ul>
<li>产品线订制灵活度高</li>
<li>与当前页面灵活交互</li>
<li>产品线接入成本底</li>
</ul>
<blockquote>
<p>缺点</p>
</blockquote>
<ul>
<li>实现成本高</li>
</ul>
<h2 id="需要考虑哪些技术点？">需要考虑哪些技术点？</h2>
<ul>
<li>基础库</li>
<li>命名空间</li>
<li>面向对象的实现</li>
<li>设计模式</li>
<li>唯一元素ID</li>
<li>CSS选择器冲突</li>
<li>跨域的POST,https请求</li>
<li>数据统计</li>
<li>多语言支持</li>
<li>多端适配</li>
<li>加密方案</li>
<li>…</li>
</ul>
<h2 id="架构">架构</h2>
<h3 id="线上部署">线上部署</h3>
<p>Server</p>
<p>Template</p>
<p>CDN</p>
<h3 id="代码结构">代码结构</h3>
<ul>
<li>基础库 jQuery，Tangram，Underscope …</li>
<li>基类<ul>
<li>base.js getId, placeholder, event ..</li>
<li>validate.js </li>
<li>suggestion.js    </li>
<li>crypt.js</li>
<li>dialog.js</li>
<li>fastclick.js</li>
</ul>
</li>
<li>业务逻辑（module）</li>
<li>业务钩子（hook）</li>
<li>性能及用户行为统计（analysis）</li>
</ul>
<h3 id="业务逻辑维度">业务逻辑维度</h3>
<ul>
<li>登录</li>
<li>登录弹框</li>
<li>注册</li>
<li>绑定手机号</li>
<li>验证手机号</li>
<li>补填用户名</li>
<li>…</li>
</ul>
<h3 id="功能维度">功能维度</h3>
<ul>
<li>基础业务逻辑（module）</li>
<li>弹框等交互逻辑(uni)</li>
<li>网络层（network）</li>
<li>语言包（lang）,unicode</li>
<li>统计（analysis）</li>
<li>业务钩子(hook)</li>
<li>配置（config）</li>
<li>基础组件（lib）</li>
<li>依赖管理（login.js,uni_login.js…）</li>
<li>资源配置（wrapper.js，uni_wrapper.js）</li>
</ul>
<h3 id="打包编译">打包编译</h3>
<ul>
<li>产品线入口文件(wrapper.js , uni_wrapper.js)</li>
<li>业务功能文件（login.js, login_tangram.js文件）</li>
<li>样式静态资源（login.css, login.png）</li>
</ul>
<h2 id="改进点">改进点</h2>
<ul>
<li>本地开发麻烦</li>
<li>没有测试用例（所有的功能手动测试）</li>
<li>没有CSS文件，image文件的自动打包功能</li>
</ul>

        
      </div>
    
    <footer>
      
        
          <div class="clearfix"></div>
          <nav id="pagination">
  
  
    <a href="/2015/02/09/shopv3/" class="alignright next">older<i class="fa fa-long-arrow-right"></i></a>
  
  <div class="clearfix"></div>
</nav>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <!-- <h1 class="title fa fa-comments"></h1> -->

  
      <!-- Duoshuo Comment BEGIN -->
<div class="ds-thread" data-thread-key="/2015/06/09/slider-test/"></div>
<!-- Duoshuo Comment END -->
  
</section>



    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div>
  
  &copy; 2015 xiongwilee
  
</div>
Powered by <a href="http://zespia.tw/hexo/" title="Hexo" target="_blank" rel="external">Hexo</a> and <a href="http://pages.github.com/" title="GitHub Pages" target="_blank" rel="external">GitHub Pages</a>

<div class="clearfix"></div></footer>
  
<script src="/js/jquery.imagesloaded.min.js" type="text/javascript"></script>
<script src="/js/gallery.js" type="text/javascript"></script>
<script src="/bootstrap/bootstrap.min.js" type="text/javascript"></script>






  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
  (function($){
    $('.fancybox').fancybox({
      'titlePosition': 'inside'
    });
  })(jQuery);
  </script>



    <script type="text/javascript">
      var duoshuoQuery = {short_name:"xiongwilee"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = 'http://static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0] 
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>


</body>
</html>